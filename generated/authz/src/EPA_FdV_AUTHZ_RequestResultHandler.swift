//----------------------------------------------------
//
// Generated by www.easywsdl.com
// Version: 5.7.0.0
//
// Created by Quasar Development 
//
//---------------------------------------------------

import Foundation

public protocol EPA_FdV_AUTHZ_ISerializableObject:NSObjectProtocol {
    func loadWithXml(__node:DDXMLElement,__request:EPA_FdV_AUTHZ_RequestResultHandler)
    func serialize(__parent:DDXMLElement, __request:EPA_FdV_AUTHZ_RequestResultHandler)
    init()
}
public protocol EPA_FdV_AUTHZ_IReferenceObject {
    
}
@objc public protocol EPA_FdV_AUTHZ_SoapServiceResponse
{
    func onSuccess( value:AnyObject?, methodName:String)
    func onError(error:Error)
}

open class EPA_FdV_AUTHZ_RequestResultHandler
{
    static let SOAPVERSION_10:Int = 1
    static let SOAPVERSION_11:Int = 2
    static let SOAPVERSION_12:Int = 3
    
    var namespaces:[NSObject:String]?
    static var classNames:NSDictionary?
    var CreateClassesForAny:Bool = false
    static var elementNames:NSDictionary?
    private var soapVersion:Int
    private var xml:DDXMLDocument?
    var Header:DDXMLElement?
    var Body:DDXMLElement?
    var OutputHeader:DDXMLElement?
    var OutputBody:DDXMLElement?
    var OutputFault:Error?
    var referencesTable=[String:NSObject]()
    var reverseReferencesTable=[NSObject:String]()
    var EnableLogging:Bool=false
    private var envNS:String
    private var networkTask:URLSessionDataTask?

    init(version:Int)
    {
        soapVersion=version
        envNS=soapVersion==EPA_FdV_AUTHZ_RequestResultHandler.SOAPVERSION_12 ? "http://www.w3.org/2003/05/soap-envelope" : "http://schemas.xmlsoap.org/soap/envelope/"
        namespaces=[NSObject:String]()
        try! createEnvelopeXml()
        if EPA_FdV_AUTHZ_RequestResultHandler.classNames  == nil
        {
            EPA_FdV_AUTHZ_RequestResultHandler.classNames=[
                    "http://www.w3.org/2000/09/xmldsig#^^SignatureType":EPA_FdV_AUTHZ_SignatureType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^SignedInfoType":EPA_FdV_AUTHZ_SignedInfoType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^CanonicalizationMethodType":EPA_FdV_AUTHZ_CanonicalizationMethodType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^SignatureMethodType":EPA_FdV_AUTHZ_SignatureMethodType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^ReferenceType":EPA_FdV_AUTHZ_ReferenceType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^TransformType":EPA_FdV_AUTHZ_TransformType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^DigestMethodType":EPA_FdV_AUTHZ_DigestMethodType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^KeyInfoType":EPA_FdV_AUTHZ_KeyInfoType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^KeyValueType":EPA_FdV_AUTHZ_KeyValueType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^RetrievalMethodType":EPA_FdV_AUTHZ_RetrievalMethodType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^X509DataType":EPA_FdV_AUTHZ_X509DataType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^X509IssuerSerialType":EPA_FdV_AUTHZ_X509IssuerSerialType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^PGPDataType":EPA_FdV_AUTHZ_PGPDataType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^SPKIDataType":EPA_FdV_AUTHZ_SPKIDataType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^ObjectType":EPA_FdV_AUTHZ_ObjectType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^ManifestType":EPA_FdV_AUTHZ_ManifestType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^SignaturePropertiesType":EPA_FdV_AUTHZ_SignaturePropertiesType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^SignaturePropertyType":EPA_FdV_AUTHZ_SignaturePropertyType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^DSAKeyValueType":EPA_FdV_AUTHZ_DSAKeyValueType.self,
                    "http://www.w3.org/2000/09/xmldsig#^^RSAKeyValueType":EPA_FdV_AUTHZ_RSAKeyValueType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^EncryptedType":EPA_FdV_AUTHZ_EncryptedType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^EncryptionMethodType":EPA_FdV_AUTHZ_EncryptionMethodType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^CipherDataType":EPA_FdV_AUTHZ_CipherDataType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^CipherReferenceType":EPA_FdV_AUTHZ_CipherReferenceType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^EncryptedDataType":EPA_FdV_AUTHZ_EncryptedDataType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^EncryptedKeyType":EPA_FdV_AUTHZ_EncryptedKeyType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^AgreementMethodType":EPA_FdV_AUTHZ_AgreementMethodType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^ReferenceType":EPA_FdV_AUTHZ_ReferenceType_1.self,
                    "http://www.w3.org/2001/04/xmlenc#^^EncryptionPropertiesType":EPA_FdV_AUTHZ_EncryptionPropertiesType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^EncryptionPropertyType":EPA_FdV_AUTHZ_EncryptionPropertyType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^DHKeyValueType":EPA_FdV_AUTHZ_DHKeyValueType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^ReferenceList":EPA_FdV_AUTHZ_ReferenceList.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^BaseIDAbstractType":EPA_FdV_AUTHZ_BaseIDAbstractType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^EncryptedElementType":EPA_FdV_AUTHZ_EncryptedElementType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AssertionType":EPA_FdV_AUTHZ_AssertionType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^SubjectType":EPA_FdV_AUTHZ_SubjectType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^SubjectConfirmationType":EPA_FdV_AUTHZ_SubjectConfirmationType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^SubjectConfirmationDataType":EPA_FdV_AUTHZ_SubjectConfirmationDataType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^KeyInfoConfirmationDataType":EPA_FdV_AUTHZ_KeyInfoConfirmationDataType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^ConditionsType":EPA_FdV_AUTHZ_ConditionsType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^ConditionAbstractType":EPA_FdV_AUTHZ_ConditionAbstractType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AudienceRestrictionType":EPA_FdV_AUTHZ_AudienceRestrictionType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^OneTimeUseType":EPA_FdV_AUTHZ_OneTimeUseType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^ProxyRestrictionType":EPA_FdV_AUTHZ_ProxyRestrictionType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AdviceType":EPA_FdV_AUTHZ_AdviceType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^StatementAbstractType":EPA_FdV_AUTHZ_StatementAbstractType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AuthnStatementType":EPA_FdV_AUTHZ_AuthnStatementType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^SubjectLocalityType":EPA_FdV_AUTHZ_SubjectLocalityType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AuthnContextType":EPA_FdV_AUTHZ_AuthnContextType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AuthzDecisionStatementType":EPA_FdV_AUTHZ_AuthzDecisionStatementType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^EvidenceType":EPA_FdV_AUTHZ_EvidenceType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AttributeStatementType":EPA_FdV_AUTHZ_AttributeStatementType.self,
                    "urn:oasis:names:tc:SAML:2.0:assertion^^AttributeType":EPA_FdV_AUTHZ_AttributeType.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^EventIdentificationType":EPA_FdV_AUTHZ_EventIdentificationType.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^AuditSourceIdentificationType":EPA_FdV_AUTHZ_AuditSourceIdentificationType.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^ActiveParticipantType":EPA_FdV_AUTHZ_ActiveParticipantType.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^ParticipantObjectIdentificationType":EPA_FdV_AUTHZ_ParticipantObjectIdentificationType.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^CodedValueType":EPA_FdV_AUTHZ_CodedValueType.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^TypeValuePairType":EPA_FdV_AUTHZ_TypeValuePairType.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^AuditMessage_ActiveParticipant":EPA_FdV_AUTHZ_AuditMessage_ActiveParticipant.self,
                    "http://ws.gematik.de/fa/phrext/v1.0^^AuditMessage":EPA_FdV_AUTHZ_AuditMessage.self,
                    "http://ws.gematik.de/tel/error/v2.0^^Error_Trace":EPA_FdV_AUTHZ_Error_Trace.self,
                    "http://ws.gematik.de/tel/error/v2.0^^Error":EPA_FdV_AUTHZ_Error.self,
                    "urn:hl7-org:v3^^ANY":EPA_FdV_AUTHZ_ANY.self,
                    "urn:hl7-org:v3^^BL":EPA_FdV_AUTHZ_BL.self,
                    "urn:hl7-org:v3^^ANYNonNull":EPA_FdV_AUTHZ_ANYNonNull.self,
                    "urn:hl7-org:v3^^BN":EPA_FdV_AUTHZ_BN.self,
                    "urn:hl7-org:v3^^BIN":EPA_FdV_AUTHZ_BIN.self,
                    "urn:hl7-org:v3^^ED":EPA_FdV_AUTHZ_ED.self,
                    "urn:hl7-org:v3^^thumbnail":EPA_FdV_AUTHZ_thumbnail.self,
                    "urn:hl7-org:v3^^ST":EPA_FdV_AUTHZ_ST.self,
                    "urn:hl7-org:v3^^CD":EPA_FdV_AUTHZ_CD.self,
                    "urn:hl7-org:v3^^CE":EPA_FdV_AUTHZ_CE.self,
                    "urn:hl7-org:v3^^CV":EPA_FdV_AUTHZ_CV.self,
                    "urn:hl7-org:v3^^CS":EPA_FdV_AUTHZ_CS.self,
                    "urn:hl7-org:v3^^CO":EPA_FdV_AUTHZ_CO.self,
                    "urn:hl7-org:v3^^CR":EPA_FdV_AUTHZ_CR.self,
                    "urn:hl7-org:v3^^SC":EPA_FdV_AUTHZ_SC.self,
                    "urn:hl7-org:v3^^II":EPA_FdV_AUTHZ_II.self,
                    "urn:hl7-org:v3^^URL":EPA_FdV_AUTHZ_URL.self,
                    "urn:hl7-org:v3^^TS":EPA_FdV_AUTHZ_TS.self,
                    "urn:hl7-org:v3^^TEL":EPA_FdV_AUTHZ_TEL.self,
                    "urn:hl7-org:v3^^ADXP":EPA_FdV_AUTHZ_ADXP.self,
                    "urn:hl7-org:v3^^adxp.delimiter":EPA_FdV_AUTHZ_adxp_x002E_delimiter.self,
                    "urn:hl7-org:v3^^adxp.country":EPA_FdV_AUTHZ_adxp_x002E_country.self,
                    "urn:hl7-org:v3^^adxp.state":EPA_FdV_AUTHZ_adxp_x002E_state.self,
                    "urn:hl7-org:v3^^adxp.county":EPA_FdV_AUTHZ_adxp_x002E_county.self,
                    "urn:hl7-org:v3^^adxp.city":EPA_FdV_AUTHZ_adxp_x002E_city.self,
                    "urn:hl7-org:v3^^adxp.postalCode":EPA_FdV_AUTHZ_adxp_x002E_postalCode.self,
                    "urn:hl7-org:v3^^adxp.streetAddressLine":EPA_FdV_AUTHZ_adxp_x002E_streetAddressLine.self,
                    "urn:hl7-org:v3^^adxp.houseNumber":EPA_FdV_AUTHZ_adxp_x002E_houseNumber.self,
                    "urn:hl7-org:v3^^adxp.houseNumberNumeric":EPA_FdV_AUTHZ_adxp_x002E_houseNumberNumeric.self,
                    "urn:hl7-org:v3^^adxp.direction":EPA_FdV_AUTHZ_adxp_x002E_direction.self,
                    "urn:hl7-org:v3^^adxp.streetName":EPA_FdV_AUTHZ_adxp_x002E_streetName.self,
                    "urn:hl7-org:v3^^adxp.streetNameBase":EPA_FdV_AUTHZ_adxp_x002E_streetNameBase.self,
                    "urn:hl7-org:v3^^adxp.streetNameType":EPA_FdV_AUTHZ_adxp_x002E_streetNameType.self,
                    "urn:hl7-org:v3^^adxp.additionalLocator":EPA_FdV_AUTHZ_adxp_x002E_additionalLocator.self,
                    "urn:hl7-org:v3^^adxp.unitID":EPA_FdV_AUTHZ_adxp_x002E_unitID.self,
                    "urn:hl7-org:v3^^adxp.unitType":EPA_FdV_AUTHZ_adxp_x002E_unitType.self,
                    "urn:hl7-org:v3^^adxp.careOf":EPA_FdV_AUTHZ_adxp_x002E_careOf.self,
                    "urn:hl7-org:v3^^adxp.censusTract":EPA_FdV_AUTHZ_adxp_x002E_censusTract.self,
                    "urn:hl7-org:v3^^adxp.deliveryAddressLine":EPA_FdV_AUTHZ_adxp_x002E_deliveryAddressLine.self,
                    "urn:hl7-org:v3^^adxp.deliveryInstallationType":EPA_FdV_AUTHZ_adxp_x002E_deliveryInstallationType.self,
                    "urn:hl7-org:v3^^adxp.deliveryInstallationArea":EPA_FdV_AUTHZ_adxp_x002E_deliveryInstallationArea.self,
                    "urn:hl7-org:v3^^adxp.deliveryInstallationQualifier":EPA_FdV_AUTHZ_adxp_x002E_deliveryInstallationQualifier.self,
                    "urn:hl7-org:v3^^adxp.deliveryMode":EPA_FdV_AUTHZ_adxp_x002E_deliveryMode.self,
                    "urn:hl7-org:v3^^adxp.deliveryModeIdentifier":EPA_FdV_AUTHZ_adxp_x002E_deliveryModeIdentifier.self,
                    "urn:hl7-org:v3^^adxp.buildingNumberSuffix":EPA_FdV_AUTHZ_adxp_x002E_buildingNumberSuffix.self,
                    "urn:hl7-org:v3^^adxp.postBox":EPA_FdV_AUTHZ_adxp_x002E_postBox.self,
                    "urn:hl7-org:v3^^adxp.precinct":EPA_FdV_AUTHZ_adxp_x002E_precinct.self,
                    "urn:hl7-org:v3^^AD":EPA_FdV_AUTHZ_AD.self,
                    "urn:hl7-org:v3^^ENXP":EPA_FdV_AUTHZ_ENXP.self,
                    "urn:hl7-org:v3^^en.delimiter":EPA_FdV_AUTHZ_en_x002E_delimiter.self,
                    "urn:hl7-org:v3^^en.family":EPA_FdV_AUTHZ_en_x002E_family.self,
                    "urn:hl7-org:v3^^en.given":EPA_FdV_AUTHZ_en_x002E_given.self,
                    "urn:hl7-org:v3^^en.prefix":EPA_FdV_AUTHZ_en_x002E_prefix.self,
                    "urn:hl7-org:v3^^en.suffix":EPA_FdV_AUTHZ_en_x002E_suffix.self,
                    "urn:hl7-org:v3^^EN":EPA_FdV_AUTHZ_EN.self,
                    "urn:hl7-org:v3^^PN":EPA_FdV_AUTHZ_PN.self,
                    "urn:hl7-org:v3^^ON":EPA_FdV_AUTHZ_ON.self,
                    "urn:hl7-org:v3^^TN":EPA_FdV_AUTHZ_TN.self,
                    "urn:hl7-org:v3^^QTY":EPA_FdV_AUTHZ_QTY.self,
                    "urn:hl7-org:v3^^INT":EPA_FdV_AUTHZ_INT.self,
                    "urn:hl7-org:v3^^REAL":EPA_FdV_AUTHZ_REAL.self,
                    "urn:hl7-org:v3^^PQR":EPA_FdV_AUTHZ_PQR.self,
                    "urn:hl7-org:v3^^PQ":EPA_FdV_AUTHZ_PQ.self,
                    "urn:hl7-org:v3^^MO":EPA_FdV_AUTHZ_MO.self,
                    "urn:hl7-org:v3^^RTO":EPA_FdV_AUTHZ_RTO.self,
                    "urn:hl7-org:v3^^EIVL.event":EPA_FdV_AUTHZ_EIVL_x002E_event.self,
                    "urn:hl7-org:v3^^SXCM_TS":EPA_FdV_AUTHZ_SXCM_TS.self,
                    "urn:hl7-org:v3^^IVL_TS":EPA_FdV_AUTHZ_IVL_TS.self,
                    "urn:hl7-org:v3^^IVXB_TS":EPA_FdV_AUTHZ_IVXB_TS.self,
                    "urn:hl7-org:v3^^RTO_QTY_QTY":EPA_FdV_AUTHZ_RTO_QTY_QTY.self,
                    "urn:hl7-org:v3^^PIVL_TS":EPA_FdV_AUTHZ_PIVL_TS.self,
                    "urn:hl7-org:v3^^EIVL_TS":EPA_FdV_AUTHZ_EIVL_TS.self,
                    "urn:hl7-org:v3^^IVL_PQ":EPA_FdV_AUTHZ_IVL_PQ.self,
                    "urn:hl7-org:v3^^SXCM_PQ":EPA_FdV_AUTHZ_SXCM_PQ.self,
                    "urn:hl7-org:v3^^IVXB_PQ":EPA_FdV_AUTHZ_IVXB_PQ.self,
                    "urn:hl7-org:v3^^PPD_TS":EPA_FdV_AUTHZ_PPD_TS.self,
                    "urn:hl7-org:v3^^PPD_PQ":EPA_FdV_AUTHZ_PPD_PQ.self,
                    "urn:hl7-org:v3^^PIVL_PPD_TS":EPA_FdV_AUTHZ_PIVL_PPD_TS.self,
                    "urn:hl7-org:v3^^SXCM_PPD_TS":EPA_FdV_AUTHZ_SXCM_PPD_TS.self,
                    "urn:hl7-org:v3^^IVL_PPD_TS":EPA_FdV_AUTHZ_IVL_PPD_TS.self,
                    "urn:hl7-org:v3^^IVXB_PPD_TS":EPA_FdV_AUTHZ_IVXB_PPD_TS.self,
                    "urn:hl7-org:v3^^EIVL_PPD_TS":EPA_FdV_AUTHZ_EIVL_PPD_TS.self,
                    "urn:hl7-org:v3^^IVL_PPD_PQ":EPA_FdV_AUTHZ_IVL_PPD_PQ.self,
                    "urn:hl7-org:v3^^SXCM_PPD_PQ":EPA_FdV_AUTHZ_SXCM_PPD_PQ.self,
                    "urn:hl7-org:v3^^IVXB_PPD_PQ":EPA_FdV_AUTHZ_IVXB_PPD_PQ.self,
                    "urn:hl7-org:v3^^SXPR_TS":EPA_FdV_AUTHZ_SXPR_TS.self,
                    "urn:hl7-org:v3^^SXCM_CD":EPA_FdV_AUTHZ_SXCM_CD.self,
                    "urn:hl7-org:v3^^SXCM_MO":EPA_FdV_AUTHZ_SXCM_MO.self,
                    "urn:hl7-org:v3^^SXCM_INT":EPA_FdV_AUTHZ_SXCM_INT.self,
                    "urn:hl7-org:v3^^SXCM_REAL":EPA_FdV_AUTHZ_SXCM_REAL.self,
                    "urn:hl7-org:v3^^IVL_INT":EPA_FdV_AUTHZ_IVL_INT.self,
                    "urn:hl7-org:v3^^IVXB_INT":EPA_FdV_AUTHZ_IVXB_INT.self,
                    "urn:hl7-org:v3^^IVL_REAL":EPA_FdV_AUTHZ_IVL_REAL.self,
                    "urn:hl7-org:v3^^IVXB_REAL":EPA_FdV_AUTHZ_IVXB_REAL.self,
                    "urn:hl7-org:v3^^IVL_MO":EPA_FdV_AUTHZ_IVL_MO.self,
                    "urn:hl7-org:v3^^IVXB_MO":EPA_FdV_AUTHZ_IVXB_MO.self,
                    "urn:hl7-org:v3^^HXIT_PQ":EPA_FdV_AUTHZ_HXIT_PQ.self,
                    "urn:hl7-org:v3^^HXIT_CE":EPA_FdV_AUTHZ_HXIT_CE.self,
                    "urn:hl7-org:v3^^BXIT_CD":EPA_FdV_AUTHZ_BXIT_CD.self,
                    "urn:hl7-org:v3^^BXIT_IVL_PQ":EPA_FdV_AUTHZ_BXIT_IVL_PQ.self,
                    "urn:hl7-org:v3^^SLIST_PQ":EPA_FdV_AUTHZ_SLIST_PQ.self,
                    "urn:hl7-org:v3^^SLIST_TS":EPA_FdV_AUTHZ_SLIST_TS.self,
                    "urn:hl7-org:v3^^GLIST_TS":EPA_FdV_AUTHZ_GLIST_TS.self,
                    "urn:hl7-org:v3^^GLIST_PQ":EPA_FdV_AUTHZ_GLIST_PQ.self,
                    "urn:hl7-org:v3^^RTO_PQ_PQ":EPA_FdV_AUTHZ_RTO_PQ_PQ.self,
                    "urn:hl7-org:v3^^RTO_MO_PQ":EPA_FdV_AUTHZ_RTO_MO_PQ.self,
                    "urn:hl7-org:v3^^UVP_TS":EPA_FdV_AUTHZ_UVP_TS.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^Kostentraeger":EPA_FdV_AUTHZ_Kostentraeger.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^LandType":EPA_FdV_AUTHZ_LandType.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML_Versicherter_Versicherungsschutz_Kostentraeger":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML_Versicherter_Versicherungsschutz_Kostentraeger.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML_Versicherter_Versicherungsschutz":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML_Versicherter_Versicherungsschutz.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos_ZusatzinfosGKV_Zusatzinfos_Abrechnung_GKV_Kostenerstattung":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos_ZusatzinfosGKV_Zusatzinfos.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos_ZusatzinfosGKV_Zusatzinfos_Abrechnung_GKV":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos_ZusatzinfosGKV_Zusatzinfos_1.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos_ZusatzinfosGKV":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos_ZusatzinfosGKV.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML_Versicherter_Zusatzinfos.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML_Versicherter":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML_Versicherter.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_AllgemeineVersicherungsdatenXML":EPA_FdV_AUTHZ_UC_AllgemeineVersicherungsdatenXML.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_PersoenlicheVersichertendatenXML_Versicherter_Person_PostfachAdresse":EPA_FdV_AUTHZ_UC_PersoenlicheVersichertendatenXML_Versicherter_Person_PostfachAdresse.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_PersoenlicheVersichertendatenXML_Versicherter_Person_StrassenAdresse":EPA_FdV_AUTHZ_UC_PersoenlicheVersichertendatenXML_Versicherter_Person_StrassenAdresse.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_PersoenlicheVersichertendatenXML_Versicherter_Person":EPA_FdV_AUTHZ_UC_PersoenlicheVersichertendatenXML_Versicherter_Person.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_PersoenlicheVersichertendatenXML_Versicherter":EPA_FdV_AUTHZ_UC_PersoenlicheVersichertendatenXML_Versicherter.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_PersoenlicheVersichertendatenXML":EPA_FdV_AUTHZ_UC_PersoenlicheVersichertendatenXML.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_GeschuetzteVersichertendatenXML_Zuzahlungsstatus":EPA_FdV_AUTHZ_UC_GeschuetzteVersichertendatenXML_Zuzahlungsstatus.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_GeschuetzteVersichertendatenXML_Selektivvertraege":EPA_FdV_AUTHZ_UC_GeschuetzteVersichertendatenXML_Selektivvertraege.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_GeschuetzteVersichertendatenXML_RuhenderLeistungsanspruch":EPA_FdV_AUTHZ_UC_GeschuetzteVersichertendatenXML_RuhenderLeistungsanspruch.self,
                    "http://ws.gematik.de/fa/vsdm/vsd/v5.2^^UC_GeschuetzteVersichertendatenXML":EPA_FdV_AUTHZ_UC_GeschuetzteVersichertendatenXML.self,
                    "http://ws.gematik.de/fa/phr/v1.1^^RecordIdentifierType":EPA_FdV_AUTHZ_RecordIdentifierType.self,
                    "http://ws.gematik.de/fa/phr/v1.1^^InsurantIdType":EPA_FdV_AUTHZ_InsurantIdType.self,
                    "http://ws.gematik.de/fa/phr/v1.1^^DeviceIdType":EPA_FdV_AUTHZ_DeviceIdType.self,
                    "http://ws.gematik.de/fa/phr/v1.1^^PHRKeyType":EPA_FdV_AUTHZ_PHRKeyType.self,
                    "http://ws.gematik.de/fa/phr/v1.1^^DischargeLetterContainerType":EPA_FdV_AUTHZ_DischargeLetterContainerType.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^RecordStateType":EPA_FdV_AUTHZ_RecordStateType.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^EncryptedKeyContainerType":EPA_FdV_AUTHZ_EncryptedKeyContainerType.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^AuthorizationKeyType":EPA_FdV_AUTHZ_AuthorizationKeyType.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^AuthorizationInfoType":EPA_FdV_AUTHZ_AuthorizationInfoType.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^GetAuthorizationKey":EPA_FdV_AUTHZ_GetAuthorizationKey.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^GetAuthorizationKeyResponse":EPA_FdV_AUTHZ_GetAuthorizationKeyResponse.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^PutAuthorizationKey":EPA_FdV_AUTHZ_PutAuthorizationKey.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^DeleteAuthorizationKey":EPA_FdV_AUTHZ_DeleteAuthorizationKey.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^ReplaceAuthorizationKey":EPA_FdV_AUTHZ_ReplaceAuthorizationKey.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^CheckRecordExists":EPA_FdV_AUTHZ_CheckRecordExists.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^CheckRecordExistsResponse":EPA_FdV_AUTHZ_CheckRecordExistsResponse.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^GetAuditEvents":EPA_FdV_AUTHZ_GetAuditEvents.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^PutNotificationInfo":EPA_FdV_AUTHZ_PutNotificationInfo.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^GetAuthorizationList":EPA_FdV_AUTHZ_GetAuthorizationList.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^GetAuthorizationListResponse":EPA_FdV_AUTHZ_GetAuthorizationListResponse.self,
                    "http://www.w3.org/2000/09/xmldsig#^^TransformsType":EPA_FdV_AUTHZ_TransformsType.self,
                    "http://www.w3.org/2001/04/xmlenc#^^TransformsType":EPA_FdV_AUTHZ_TransformsType_1.self,
                    "http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1^^GetAuditEventsResponse":EPA_FdV_AUTHZ_GetAuditEventsResponse.self,
            ]
                 EPA_FdV_AUTHZ_RequestResultHandler.elementNames=[
                 "http://www.w3.org/2000/09/xmldsig#^^Signature":"http://www.w3.org/2000/09/xmldsig#^^SignatureType",
                 "http://www.w3.org/2000/09/xmldsig#^^SignatureValue":"http://www.w3.org/2000/09/xmldsig#^^SignatureValueType",
                 "http://www.w3.org/2000/09/xmldsig#^^SignedInfo":"http://www.w3.org/2000/09/xmldsig#^^SignedInfoType",
                 "http://www.w3.org/2000/09/xmldsig#^^CanonicalizationMethod":"http://www.w3.org/2000/09/xmldsig#^^CanonicalizationMethodType",
                 "http://www.w3.org/2000/09/xmldsig#^^SignatureMethod":"http://www.w3.org/2000/09/xmldsig#^^SignatureMethodType",
                 "http://www.w3.org/2000/09/xmldsig#^^Reference":"http://www.w3.org/2000/09/xmldsig#^^ReferenceType",
                 "http://www.w3.org/2000/09/xmldsig#^^Transforms":"http://www.w3.org/2000/09/xmldsig#^^TransformsType",
                 "http://www.w3.org/2000/09/xmldsig#^^Transform":"http://www.w3.org/2000/09/xmldsig#^^TransformType",
                 "http://www.w3.org/2000/09/xmldsig#^^DigestMethod":"http://www.w3.org/2000/09/xmldsig#^^DigestMethodType",
                 "http://www.w3.org/2000/09/xmldsig#^^KeyInfo":"http://www.w3.org/2000/09/xmldsig#^^KeyInfoType",
                 "http://www.w3.org/2000/09/xmldsig#^^KeyValue":"http://www.w3.org/2000/09/xmldsig#^^KeyValueType",
                 "http://www.w3.org/2000/09/xmldsig#^^RetrievalMethod":"http://www.w3.org/2000/09/xmldsig#^^RetrievalMethodType",
                 "http://www.w3.org/2000/09/xmldsig#^^X509Data":"http://www.w3.org/2000/09/xmldsig#^^X509DataType",
                 "http://www.w3.org/2000/09/xmldsig#^^PGPData":"http://www.w3.org/2000/09/xmldsig#^^PGPDataType",
                 "http://www.w3.org/2000/09/xmldsig#^^SPKIData":"http://www.w3.org/2000/09/xmldsig#^^SPKIDataType",
                 "http://www.w3.org/2000/09/xmldsig#^^Object":"http://www.w3.org/2000/09/xmldsig#^^ObjectType",
                 "http://www.w3.org/2000/09/xmldsig#^^Manifest":"http://www.w3.org/2000/09/xmldsig#^^ManifestType",
                 "http://www.w3.org/2000/09/xmldsig#^^SignatureProperties":"http://www.w3.org/2000/09/xmldsig#^^SignaturePropertiesType",
                 "http://www.w3.org/2000/09/xmldsig#^^SignatureProperty":"http://www.w3.org/2000/09/xmldsig#^^SignaturePropertyType",
                 "http://www.w3.org/2000/09/xmldsig#^^DSAKeyValue":"http://www.w3.org/2000/09/xmldsig#^^DSAKeyValueType",
                 "http://www.w3.org/2000/09/xmldsig#^^RSAKeyValue":"http://www.w3.org/2000/09/xmldsig#^^RSAKeyValueType",
                 "http://www.w3.org/2001/04/xmlenc#^^CipherData":"http://www.w3.org/2001/04/xmlenc#^^CipherDataType",
                 "http://www.w3.org/2001/04/xmlenc#^^CipherReference":"http://www.w3.org/2001/04/xmlenc#^^CipherReferenceType",
                 "http://www.w3.org/2001/04/xmlenc#^^EncryptedData":"http://www.w3.org/2001/04/xmlenc#^^EncryptedDataType",
                 "http://www.w3.org/2001/04/xmlenc#^^EncryptedKey":"http://www.w3.org/2001/04/xmlenc#^^EncryptedKeyType",
                 "http://www.w3.org/2001/04/xmlenc#^^AgreementMethod":"http://www.w3.org/2001/04/xmlenc#^^AgreementMethodType",
                 "http://www.w3.org/2001/04/xmlenc#^^EncryptionProperties":"http://www.w3.org/2001/04/xmlenc#^^EncryptionPropertiesType",
                 "http://www.w3.org/2001/04/xmlenc#^^EncryptionProperty":"http://www.w3.org/2001/04/xmlenc#^^EncryptionPropertyType",
                 "http://www.w3.org/2001/04/xmlenc#^^DHKeyValue":"http://www.w3.org/2001/04/xmlenc#^^DHKeyValueType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^BaseID":"urn:oasis:names:tc:SAML:2.0:assertion^^BaseIDAbstractType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^NameID":"urn:oasis:names:tc:SAML:2.0:assertion^^NameIDType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^EncryptedID":"urn:oasis:names:tc:SAML:2.0:assertion^^EncryptedElementType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Issuer":"urn:oasis:names:tc:SAML:2.0:assertion^^NameIDType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Assertion":"urn:oasis:names:tc:SAML:2.0:assertion^^AssertionType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Subject":"urn:oasis:names:tc:SAML:2.0:assertion^^SubjectType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^SubjectConfirmation":"urn:oasis:names:tc:SAML:2.0:assertion^^SubjectConfirmationType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^SubjectConfirmationData":"urn:oasis:names:tc:SAML:2.0:assertion^^SubjectConfirmationDataType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Conditions":"urn:oasis:names:tc:SAML:2.0:assertion^^ConditionsType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Condition":"urn:oasis:names:tc:SAML:2.0:assertion^^ConditionAbstractType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^AudienceRestriction":"urn:oasis:names:tc:SAML:2.0:assertion^^AudienceRestrictionType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^OneTimeUse":"urn:oasis:names:tc:SAML:2.0:assertion^^OneTimeUseType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^ProxyRestriction":"urn:oasis:names:tc:SAML:2.0:assertion^^ProxyRestrictionType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Advice":"urn:oasis:names:tc:SAML:2.0:assertion^^AdviceType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^EncryptedAssertion":"urn:oasis:names:tc:SAML:2.0:assertion^^EncryptedElementType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Statement":"urn:oasis:names:tc:SAML:2.0:assertion^^StatementAbstractType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^AuthnStatement":"urn:oasis:names:tc:SAML:2.0:assertion^^AuthnStatementType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^SubjectLocality":"urn:oasis:names:tc:SAML:2.0:assertion^^SubjectLocalityType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^AuthnContext":"urn:oasis:names:tc:SAML:2.0:assertion^^AuthnContextType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^AuthzDecisionStatement":"urn:oasis:names:tc:SAML:2.0:assertion^^AuthzDecisionStatementType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Action":"urn:oasis:names:tc:SAML:2.0:assertion^^ActionType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Evidence":"urn:oasis:names:tc:SAML:2.0:assertion^^EvidenceType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^AttributeStatement":"urn:oasis:names:tc:SAML:2.0:assertion^^AttributeStatementType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^Attribute":"urn:oasis:names:tc:SAML:2.0:assertion^^AttributeType",
                 "urn:oasis:names:tc:SAML:2.0:assertion^^EncryptedAttribute":"urn:oasis:names:tc:SAML:2.0:assertion^^EncryptedElementType",
                 "http://ws.gematik.de/fa/phr/v1.1^^RecordIdentifier":"http://ws.gematik.de/fa/phr/v1.1^^RecordIdentifierType",
                 "http://ws.gematik.de/fa/phr/v1.1^^DeviceId":"http://ws.gematik.de/fa/phr/v1.1^^DeviceIdType",
                 "http://ws.gematik.de/fa/phr/v1.1^^PHRKey":"http://ws.gematik.de/fa/phr/v1.1^^PHRKeyType",
                 "http://ws.gematik.de/fa/phr/v1.1^^DischargeLetterContainer":"http://ws.gematik.de/fa/phr/v1.1^^DischargeLetterContainerType",
             ]
        }
    }
    
    var envelopeString:String?{
        return xml?.rootElement()?.xmlString
    }
    
    @discardableResult func createEnvelopeXml() throws -> DDXMLDocument
    {
        var envelope:String?
        if soapVersion == EPA_FdV_AUTHZ_RequestResultHandler.SOAPVERSION_12
        {
            envelope = String("<soap:Envelope xmlns:c=\"http://www.w3.org/2003/05/soap-encoding\" xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\"></soap:Envelope>")
        }
        else
        {
            envelope = String("<soap:Envelope xmlns:c=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"></soap:Envelope>")
        }
    
        xml = try DDXMLDocument(xmlString: envelope!, options: 0)
    
        let root=xml!.rootElement()
        Header=DDXMLElement(name: "soap:Header")
        Body=DDXMLElement(name: "soap:Body")
        root?.addChild(Header!)
        root?.addChild(Body!)
        return xml!
    }

    public func getAny(node:DDXMLElement) -> Any
    {
        if self.CreateClassesForAny
        {
            var key=node.uri!+"^^"+node.localName!
            let tempKey=EPA_FdV_AUTHZ_RequestResultHandler.elementNames!.object(forKey:key) as? String
            if tempKey != nil
            {
                key=tempKey!
            }
            let type = EPA_FdV_AUTHZ_RequestResultHandler.classNames!.object(forKey:key)
            if type != nil
            {
                let obj=createInstance(type: type as! NSObject.Type ,node:node, request:self)
                return obj
            }
        }
        return node;
    }    
    func createObject(node:DDXMLElement, type:NSObject.Type) throws ->NSObject?
    {
        var localType:NSObject.Type=type
        var localNode=node
        let refAttr=EPA_FdV_AUTHZ_Helper.getAttribute(node: node, name:"Ref", url:EPA_FdV_AUTHZ_Helper.MS_SERIALIZATION_NS)
        if refAttr != nil
        {
            return referencesTable[refAttr!.stringValue!]!
        }
    
        let nilAttr=EPA_FdV_AUTHZ_Helper.getAttribute(node: node, name:"nil", url:EPA_FdV_AUTHZ_Helper.XSI)
        if nilAttr != nil && EPA_FdV_AUTHZ_Helper.toBoolFromString(str: nilAttr!.stringValue!)
        {
            return nil
        }
    
        let typeAttr=EPA_FdV_AUTHZ_Helper.getAttribute(node: node, name:"type", url:EPA_FdV_AUTHZ_Helper.XSI)
        if typeAttr != nil
        {
            let attrValue = typeAttr!.stringValue!
            let splitString=attrValue.components(separatedBy:":")
            let namespace=node.resolveNamespace(forName: attrValue)
            let typeName=splitString.count == 2 ? splitString[1] : attrValue
            if namespace != nil
            {
                let classType=namespace!.stringValue!+"^^"+typeName
                let temp:NSObject.Type?=EPA_FdV_AUTHZ_RequestResultHandler.classNames!.object(forKey: classType) as? NSObject.Type
                if temp != nil
                {
                    localType=temp!
                }
            }
        }
    
        var hrefAttr = EPA_FdV_AUTHZ_Helper.getAttribute(node: node, name:"href", url:"")
        if hrefAttr == nil
        {
            hrefAttr = EPA_FdV_AUTHZ_Helper.getAttribute(node: node, name:"ref", url:"")
        }
        if hrefAttr != nil
        {
            let str=hrefAttr!.stringValue!
            let index=str.index(str.startIndex,offsetBy:1)
            let hrefId = String(str[index...])
            let xpathQuery=String(format:"//*[@id='%@']",hrefId)
            let nodes = try node.rootDocument!.nodes(forXPath:xpathQuery)
    
            if nodes.count>0
            {
                localNode=nodes[0] as! DDXMLElement
            }
        }
    
        let obj=createInstance(type: localType ,node:localNode, request:self)
    
        return obj
    }
    
    func createInstance(type:NSObject.Type, node:DDXMLElement, request:EPA_FdV_AUTHZ_RequestResultHandler) ->NSObject
    {
        let allocObj=type.init()  as!EPA_FdV_AUTHZ_ISerializableObject
        let idAttr = EPA_FdV_AUTHZ_Helper.getAttribute(node: node, name:"Id", url:EPA_FdV_AUTHZ_Helper.MS_SERIALIZATION_NS)
        if idAttr != nil
        {
            referencesTable[idAttr!.stringValue!]=(allocObj as! NSObject)
        }
        allocObj.loadWithXml(__node: node,__request:self)
        return allocObj as! NSObject
    }
    
    func getNamespacePrefix(url:String?, propertyElement:DDXMLElement) ->String?
    {
        if url == nil || url!.isEmpty
        {
            return nil
        }
        let rootElement=propertyElement.rootDocument!.rootElement()
        
        var prefix = namespaces![url! as NSObject]
        if prefix == nil
        {
            prefix=String(format:"n%lu",namespaces!.count+1)
            let ns=DDXMLNode.namespace(withName:prefix! ,stringValue: url!)
            rootElement!.addNamespace(ns as! DDXMLNode)
            namespaces![prefix! as NSObject]=url!
        }
        return prefix
    }
    
    func getXmlFullName( name:String, URI:String? ,propertyElement:DDXMLElement)  ->String
    {
        let prefix=getNamespacePrefix(url: URI ,propertyElement: propertyElement)
        var fullname=name
        if prefix != nil
        {
            fullname=prefix!+":"+name
        }
        return fullname
    }
    
    @discardableResult func addAttribute(name:String, URI:String?, stringValue:String, element:DDXMLElement)  -> DDXMLNode
    {
        let fullname=getXmlFullName(name: name, URI:URI, propertyElement:element)
        let refAttr=DDXMLNode.attribute(withName:fullname, stringValue:stringValue) as! DDXMLNode
        element.addAttribute(refAttr)
        return refAttr
    }
    
    @discardableResult func writeElement (name:String, URI: String, parent:DDXMLElement)  -> DDXMLElement
    {
        let fullname = getXmlFullName(name: name ,URI: URI ,propertyElement: parent)
        let propertyElement=DDXMLElement(name:fullname)
        parent.addChild(propertyElement)
        return propertyElement
    }
    
    @discardableResult func writeElement(obj:Any?, type:Any.Type, name:String, URI:String, parent:DDXMLElement, skipNullProperty:Bool)  -> DDXMLElement?
    {
        if obj == nil && skipNullProperty
        {
            return nil
        }
        let propertyElement=writeElement(name: name, URI:URI, parent:parent)
    
        if obj==nil
        {
            addAttribute(name: "nil", URI:EPA_FdV_AUTHZ_Helper.XSI, stringValue:"true", element:propertyElement)
            return nil
        }
        
        if  obj is EPA_FdV_AUTHZ_IReferenceObject
        {
            let anyObj = obj as! NSObject
            let key=NSValue(nonretainedObject: anyObj)
            var idStr=reverseReferencesTable[key];
            if idStr != nil
            {
                addAttribute(name: "Ref" ,URI:EPA_FdV_AUTHZ_Helper.MS_SERIALIZATION_NS ,stringValue:idStr!, element:propertyElement)
                return nil
            }
            
            idStr=String(format:"i%lu",reverseReferencesTable.count+1)
            addAttribute(name: "Id", URI:EPA_FdV_AUTHZ_Helper.MS_SERIALIZATION_NS, stringValue:idStr!, element:propertyElement)
            reverseReferencesTable[key]=idStr
        }
    
        if let anyObj = obj as? NSObject
        {
            let currentType=Swift.type(of:anyObj);
            if currentType != type.self
            {
                let xmlType=EPA_FdV_AUTHZ_RequestResultHandler.classNames?.allKeys(for: currentType).last as? String
                //let xmlType=RequestResultHandler.classNames?.keysForValue(currentType!).last
                //let xmlType=RequestResultHandler.classNames.allKeysForValue(currentType!).last
                if xmlType != nil
                {
                    
                    let splitType = xmlType!.components(separatedBy:"^^")
                    let fullname=getXmlFullName(name: splitType[1], URI:splitType[0], propertyElement:propertyElement)
                    addAttribute(name: "type" ,URI:EPA_FdV_AUTHZ_Helper.XSI, stringValue:fullname, element:propertyElement)
                }
                
            }
        }
        
        return propertyElement
    }
    
    func setResponse(responseData:Data, response:URLResponse?) throws
    {
        if self.EnableLogging
        {
            let strResponse=String(data: responseData, encoding: String.Encoding.utf8)
            NSLog("%@",strResponse!)
        }
        let __doc = try DDXMLDocument(data: responseData, options: 0)
        let __root=__doc.rootElement()
        if __root == nil
        {
            let errorMessage = String(data: responseData, encoding:String.Encoding.utf8)
            OutputFault=NSError(domain: errorMessage!, code:0, userInfo:nil)
            return
        }
        OutputBody=EPA_FdV_AUTHZ_Helper.getNode(node: __root,  name:"Body", URI:envNS)
        OutputHeader=EPA_FdV_AUTHZ_Helper.getNode(node: __root,  name:"Header", URI:envNS)
        if OutputBody == nil
        {
            let errorMessage = String(data: responseData, encoding:String.Encoding.utf8)
            OutputFault=NSError(domain: errorMessage!, code:0, userInfo:nil)
            return
        }
        let fault=EPA_FdV_AUTHZ_Helper.getNode(node: OutputBody!, name:"Fault",URI:envNS)
        if fault != nil
        {
            var faultString=EPA_FdV_AUTHZ_Helper.getNode(node: fault!, name:"faultstring")
            if faultString == nil
            {
                let reasonNode=EPA_FdV_AUTHZ_Helper.getNode(node: fault!, name:"Reason")
                if reasonNode != nil
                {
                    faultString=EPA_FdV_AUTHZ_Helper.getNode(node: reasonNode!, name:"Text")
                }
            }
            var faultObj:AnyObject?=nil;
            var faultDetail=EPA_FdV_AUTHZ_Helper.getNode(node: fault!, name:"detail")
            if faultDetail == nil
            {
                faultDetail=EPA_FdV_AUTHZ_Helper.getNode(node: fault!, name:"Detail")
            }
            if faultDetail != nil
            {
                let faultClass=faultDetail!.child(at:0) as? DDXMLElement
                if faultClass != nil
                {
                    let typeName=faultClass!.localName!
                    let namespaceNode=faultClass!.resolveNamespace(forName:typeName)
                    var namespace:String?=nil;
                    if(namespaceNode==nil)
                    {
                        namespace=faultClass!.uri
                    }
                    else
                    {
                        namespace=namespaceNode!.stringValue
                    }
                    let classType=String(format:"%@^^%@",namespace!,typeName)
                    let temp=EPA_FdV_AUTHZ_RequestResultHandler.classNames!.object( forKey: classType)
                    if temp != nil
                    {
                        faultObj = createInstance(type: temp as! NSObject.Type, node:faultClass!, request:self)
                    }
                }
            }
    
            OutputFault=EPA_FdV_AUTHZ_SoapError(message: faultString!.stringValue!, details:faultObj)
        }
    }
    
    func createNSURLSession () -> URLSession
    {
        let sessionConfiguration = URLSessionConfiguration.default
        let connection = URLSession(configuration: sessionConfiguration)
        return connection
    }
    
    func sendImplementation(request:URLRequest) throws
    {
        if self.EnableLogging
        {
            let strRequest = String(data: request.httpBody!, encoding: String.Encoding.utf8)
            NSLog("%@\n", strRequest!)
        }
    
        var response:URLResponse?
        var data:Data?
        var innerError:Error?
    
        let sem = DispatchSemaphore(value: 0)
    
        let connection=createNSURLSession()
        let task = connection.dataTask(with: request,completionHandler: {
            taskData, responseObj ,error ->() in
            
            if error != nil
            {
                innerError=error!
            }
            if responseObj != nil
            {
                response=responseObj!
            }
            if error == nil
            {
                data=taskData
            }
            sem.signal()
        })
        task.resume()
        
        _ = sem.wait(timeout: DispatchTime.distantFuture)
        if data == nil{
            OutputFault = innerError
        }
        else
        {
            try setResponse(responseData: data!, response: response!)
        }
    }
    
    
    
    func sendImplementation(request:URLRequest,  callbackDelegate: @escaping(EPA_FdV_AUTHZ_RequestResultHandler) -> ()) throws
    {
        if self.EnableLogging
        {
            let strRequest = String(data: request.httpBody!, encoding: String.Encoding.utf8)
            NSLog("%@\n", strRequest!)
        }
        let connection=createNSURLSession()
        networkTask=connection.dataTask(with: request,completionHandler: {
            taskData, responseObj ,error ->() in
            self.OutputFault=error
            if error == nil
            {
                do{
                    try self.setResponse(responseData:taskData!, response: responseObj!)
                }
                catch
                {
                    let httpResponse=(responseObj as? HTTPURLResponse)
                    self.OutputFault = NSError(domain: HTTPURLResponse.localizedString(forStatusCode: httpResponse!.statusCode), code: httpResponse!.statusCode)
                }
            }
            
            if self.OutputFault == nil || self.OutputFault?._code != NSURLErrorCancelled
            {
                callbackDelegate(self)
            }

            self.networkTask=nil
        })
        
        networkTask?.resume()
    }
    
    func Cancel()
    {
        if networkTask != nil
        {
            networkTask?.cancel()
            networkTask=nil
        }
    }
    
    func prepareRequest(__requestObj:inout URLRequest)
    {
        var __soapMessageData:Data?
            __soapMessageData=envelopeString!.data(using: String.Encoding.utf8)
            __requestObj.addValue(soapVersion==EPA_FdV_AUTHZ_RequestResultHandler.SOAPVERSION_12 ? "application/soap+xml; charset=utf-8" : "text/xml; charset=utf-8", forHTTPHeaderField: "Content-Type")
        let msgLength=String(format: "%u", __soapMessageData!.count)
    
        __requestObj.addValue(msgLength, forHTTPHeaderField:"Content-Length")
        __requestObj.httpBody=__soapMessageData
    }


    func setBinary(propertyElement:DDXMLNode, data:Data, isSwaRef:Bool, isAttribute:Bool)
    {
        propertyElement.stringValue = EPA_FdV_AUTHZ_Helper.base64forData(data: data)
    }

    func getBinary(element:DDXMLNode, isSwaRef:Bool, isAttribute:Bool) -> Data
    {
        return EPA_FdV_AUTHZ_Helper.base64DataFromString(string: element.stringValue!)
    }    


    func addWS_addressingHeaders(action:String,replyTo:String, to:String, referenceParameters:[String])
    {
        var __wsaddressingElement=writeElement(name: "Action", URI:"http://www.w3.org/2005/08/addressing", parent:self.Header!)
        __wsaddressingElement.stringValue = action
        addAttribute(name: "mustUnderstand", URI:envNS, stringValue:"1", element:__wsaddressingElement)
        __wsaddressingElement=writeElement(name: "MessageID", URI:"http://www.w3.org/2005/08/addressing", parent:self.Header!)
        __wsaddressingElement.stringValue = "urn:uuid:" + EPA_FdV_AUTHZ_Helper.createGuid()
        __wsaddressingElement=writeElement(name: "ReplyTo", URI:"http://www.w3.org/2005/08/addressing", parent:self.Header!)
        __wsaddressingElement=writeElement(name: "Address", URI:"http://www.w3.org/2005/08/addressing", parent:__wsaddressingElement)
        __wsaddressingElement.stringValue = replyTo
        __wsaddressingElement=writeElement(name: "To", URI:"http://www.w3.org/2005/08/addressing", parent:self.Header!)
        __wsaddressingElement.stringValue = to
        addAttribute(name: "mustUnderstand", URI:envNS, stringValue:"1", element:__wsaddressingElement)
        for param in referenceParameters
        {
            let __doc=try! DDXMLDocument(xmlString:param, options:0)
            let root=__doc.rootElement()
            root!.detach()
            self.Header!.addChild(root!)
            addAttribute(name: "IsReferenceParameter", URI:"http://www.w3.org/2005/08/addressing", stringValue:"true", element:root!)
        }
    }

    func getAnyTypeValue(node:DDXMLElement) -> NSObject
    {
        let  typeAttr=EPA_FdV_AUTHZ_Helper.getAttribute(node: node, name:"type", url:EPA_FdV_AUTHZ_Helper.XSI)
        if typeAttr != nil
        {
            let attrValue=typeAttr!.stringValue
            let splitString=attrValue!.components(separatedBy:":")
            if splitString.count==2
            {
                let namespace=node.resolveNamespace(forName: attrValue!)
                if namespace?.stringValue == "http://www.w3.org/2001/XMLSchema"
                {
                    let value=splitString[1]
                    if value == "int" || value == "double" || value == "float" || value == "long" || value == "integer" || value == "byte" || value == "negativeInteger"
                        || value == "nonNegativeInteger" || value ==  "nonPositiveInteger" || value == "positiveInteger"  || value == "short" || value == "unsignedLong" || value == "unsignedInt" || value == "unsignedShort" || value == "unsignedByte"
                    {
                        return EPA_FdV_AUTHZ_Helper.getNumber(stringNumber: node.stringValue, isDecimal:false)!
                    }
                    else if value == "decimal"
                    {
                        return EPA_FdV_AUTHZ_Helper.getNumber(stringNumber: node.stringValue, isDecimal:true)!
                    }
                    else if value == "boolean"
                    {
                        return (node.stringValue! == "true") as NSObject
                    }
                    else
                    {
                        return node.stringValue! as NSObject
                    }
                }
                else
                {
                    let typeName=splitString.count==2 ? splitString[1] : attrValue
                    if namespace != nil
                    {
                        let classType=String(format:"%@^^%@",namespace!.stringValue!,typeName!)
                        let temp=EPA_FdV_AUTHZ_RequestResultHandler.classNames!.object(forKey: classType) as? NSObject.Type
                        if temp != nil
                        {
                            return  createInstance(type: temp! ,node:node, request:self)
                        }
                    }
                }
            }
        }
        return node;
    }

    func setAnyTypeValue(item:NSObject, propertyElement:DDXMLElement)
    {
        if let obj1 = item as? EPA_FdV_AUTHZ_ISerializableObject
        {
            obj1.serialize(__parent: propertyElement ,__request:self)
        }
        else if let str = item as? String
        {
            let prefix=getNamespacePrefix(url: "http://www.w3.org/2001/XMLSchema", propertyElement:propertyElement)
            addAttribute(name: "type", URI:"http://www.w3.org/2001/XMLSchema-instance", stringValue:String(format:"%@:string", prefix!), element:propertyElement)
            propertyElement.stringValue = str
        }
        else if let number = item as? NSDecimalNumber
        {
            let prefix=getNamespacePrefix(url: "http://www.w3.org/2001/XMLSchema", propertyElement:propertyElement)
            addAttribute(name: "type", URI:"http://www.w3.org/2001/XMLSchema-instance", stringValue:String(format:"%@:decimal", prefix!), element:propertyElement)
            propertyElement.stringValue = number.stringValue
        }
        else if let nsnumber = item as? NSNumber
        {
            let prefix=getNamespacePrefix(url: "http://www.w3.org/2001/XMLSchema", propertyElement:propertyElement)
            let cStrintType = String(cString: nsnumber.objCType)
            if cStrintType == "q"
            {
                addAttribute(name: "type", URI:"http://www.w3.org/2001/XMLSchema-instance", stringValue:String(format:"%@:int", prefix!), element:propertyElement)
            }
            else if cStrintType == "f"
            {
                addAttribute(name: "type", URI:"http://www.w3.org/2001/XMLSchema-instance", stringValue:String(format:"%@:float", prefix!), element:propertyElement)
            }
            else if cStrintType == "i"
            {
                addAttribute(name: "type", URI:"http://www.w3.org/2001/XMLSchema-instance", stringValue:String(format:"%@:int", prefix!), element:propertyElement)
            }
            else if cStrintType == "c"
            {
               // print("bool")
                addAttribute(name: "type", URI:"http://www.w3.org/2001/XMLSchema-instance", stringValue:String(format:"%@:boolean", prefix!), element:propertyElement)
            }
            else if cStrintType == "d"
            {
                //print("double")
                addAttribute(name: "type", URI:"http://www.w3.org/2001/XMLSchema-instance", stringValue:String(format:"%@:double", prefix!), element:propertyElement)
            }
            propertyElement.stringValue = nsnumber.stringValue
        }
        else
        {
            propertyElement.stringValue = item.description
        }
    }

}