//----------------------------------------------------
//
// Generated by www.easywsdl.com
// Version: 5.7.0.0
//
// Created by Quasar Development 
//
//---------------------------------------------------


open class EPA_FdV_AUTHZ_I_Authorization_InsurantBinding:NSObject
{
    var Url:String? = "http://unspecified"
    var EnableLogging:Bool=false
    var Headers=[String:String]()
    var ShouldAddAdornments=true
    var Username:String?
    var Password:String?
    var CreateClassesForAny:Bool=false
    public override init()
    {

    }

    public init(url:String?)
    {
        Url=url
    }

    func sendImplementation(request:URLRequest, requestMgr:EPA_FdV_AUTHZ_RequestResultHandler) throws
    {
        try requestMgr.sendImplementation(request: request)
    }
    func sendImplementation(request:URLRequest, requestMgr:EPA_FdV_AUTHZ_RequestResultHandler, callbackDelegate: @escaping (EPA_FdV_AUTHZ_RequestResultHandler) -> ()) throws
    {
        try requestMgr.sendImplementation(request: request, callbackDelegate:callbackDelegate)
    }
    func CreateRequestResultHandler() -> EPA_FdV_AUTHZ_RequestResultHandler
    {
        let handler = EPA_FdV_AUTHZ_RequestResultHandler(version: EPA_FdV_AUTHZ_RequestResultHandler.SOAPVERSION_12)
            handler.CreateClassesForAny = self.CreateClassesForAny
        handler.EnableLogging = EnableLogging
        return handler
    }

    func createRequest(__soapAction:String, __request:EPA_FdV_AUTHZ_RequestResultHandler)  -> URLRequest
    {
        let __url = URL(string: Url!)
        var __requestObj = URLRequest(url: __url!)

        __request.prepareRequest(__requestObj: &__requestObj)

        __requestObj.addValue(__soapAction,forHTTPHeaderField:"SOAPAction")

        for (key,value) in self.Headers
        {
            __requestObj.addValue(value, forHTTPHeaderField:key)
        }
        __requestObj.httpMethod="POST"

        if Username != nil
        {
            let authStr = String(format:"%@:%@", self.Username!,self.Password!)
            let authData = authStr.data(using:String.Encoding.ascii)
            let authValue = String(format:"Basic %@", EPA_FdV_AUTHZ_Helper.base64forData(data: authData!))
            __requestObj.setValue(authValue, forHTTPHeaderField:"Authorization")
        }
        return __requestObj
    }

    func addAdornments(__methodElement:DDXMLElement)
    {
        if ShouldAddAdornments
        {
            __methodElement.addAttribute(DDXMLNode.attribute(withName:"id" ,stringValue:"o0") as! DDXMLNode)
            __methodElement.addAttribute(DDXMLNode.attribute(withName:"c:root", stringValue:"1") as! DDXMLNode)
        }
    }
    func createGetAuthorizationKeyRequest(RecordIdentifier:EPA_FdV_AUTHZ_RecordIdentifierType, DeviceID:EPA_FdV_AUTHZ_DeviceIdType?, __request:EPA_FdV_AUTHZ_RequestResultHandler)  -> URLRequest
    {
        let __methodElement = __request.writeElement(name: "GetAuthorizationKey", URI:"http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1", parent:__request.Body!)
        addAdornments(__methodElement: __methodElement)
            
        let __RecordIdentifierItemElement=__request.writeElement(obj: RecordIdentifier, type:EPA_FdV_AUTHZ_RecordIdentifierType.self, name:"RecordIdentifier", URI:"http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1", parent:__methodElement, skipNullProperty:false)
        if __RecordIdentifierItemElement != nil
        {
            RecordIdentifier.serialize(__parent: __RecordIdentifierItemElement!, __request: __request);
        }
            
        let __DeviceIDItemElement=__request.writeElement(obj: DeviceID, type:EPA_FdV_AUTHZ_DeviceIdType.self, name:"DeviceID", URI:"http://ws.gematik.de/fd/phrs/AuthorizationService/v1.1", parent:__methodElement, skipNullProperty:true)
        if __DeviceIDItemElement != nil
        {
            DeviceID!.serialize(__parent: __DeviceIDItemElement!, __request: __request);
        }
        let __requestObj = createRequest(__soapAction: "http://ws.gematik.de/fd/phrs/AuthorizationInsurantService/v1.0#GetAuthorizationKey", __request:__request)
        return __requestObj;
    }

    @discardableResult public func GetAuthorizationKeyAsync(RecordIdentifier:EPA_FdV_AUTHZ_RecordIdentifierType, DeviceID:EPA_FdV_AUTHZ_DeviceIdType?, callbackDelegate: @escaping (AnyObject?) -> ()) throws -> EPA_FdV_AUTHZ_RequestResultHandler
    {
        let __request = CreateRequestResultHandler()
        let __requestObj=createGetAuthorizationKeyRequest(RecordIdentifier: RecordIdentifier, DeviceID: DeviceID, __request:__request)
        
        try sendImplementation(request: __requestObj, requestMgr:__request, callbackDelegate: {
            __requestMgr->() in
            var __res:AnyObject?
            if __requestMgr.OutputFault == nil
            {
                let __result=EPA_FdV_AUTHZ_Helper.getResultElement(body: __request.OutputBody!, name:"GetAuthorizationKeyResponse")
                __res = try! __request.createObject(node: __result, type:EPA_FdV_AUTHZ_GetAuthorizationKeyResponse.self) as? EPA_FdV_AUTHZ_GetAuthorizationKeyResponse as AnyObject;
            }
            else
            {
                __res = __requestMgr.OutputFault! as AnyObject
            }
            callbackDelegate(__res)
        })
        return __request;
    }

    @discardableResult public func GetAuthorizationKeyAsync(RecordIdentifier:EPA_FdV_AUTHZ_RecordIdentifierType, DeviceID:EPA_FdV_AUTHZ_DeviceIdType?, __target:EPA_FdV_AUTHZ_SoapServiceResponse) throws -> EPA_FdV_AUTHZ_RequestResultHandler
    {
        let __request = CreateRequestResultHandler()
        let __requestObj=createGetAuthorizationKeyRequest(RecordIdentifier: RecordIdentifier, DeviceID: DeviceID, __request:__request)
        
        try sendImplementation(request: __requestObj, requestMgr:__request, callbackDelegate: {
            __requestMgr->() in
            if __requestMgr.OutputFault == nil
            {
                let __result=EPA_FdV_AUTHZ_Helper.getResultElement(body: __request.OutputBody!, name:"GetAuthorizationKeyResponse")
                __target.onSuccess(value: try! __request.createObject(node: __result, type:EPA_FdV_AUTHZ_GetAuthorizationKeyResponse.self) as? EPA_FdV_AUTHZ_GetAuthorizationKeyResponse as AnyObject, methodName:"GetAuthorizationKey")
            }
            else
            {
                __target.onError(error: __requestMgr.OutputFault!)
            }
        })
        return __request;
    }

    public func GetAuthorizationKey(RecordIdentifier:EPA_FdV_AUTHZ_RecordIdentifierType, DeviceID:EPA_FdV_AUTHZ_DeviceIdType?, __error: inout Error?) throws  -> EPA_FdV_AUTHZ_GetAuthorizationKeyResponse?
    {
        let __request = CreateRequestResultHandler()
        let __requestObj=createGetAuthorizationKeyRequest(RecordIdentifier: RecordIdentifier, DeviceID: DeviceID, __request:__request)
        try sendImplementation(request: __requestObj, requestMgr:__request)
        if __request.OutputFault != nil
        {
            __error=__request.OutputFault!
            return nil;
        }
        let __result=EPA_FdV_AUTHZ_Helper.getResultElement(body: __request.OutputBody!, name:"GetAuthorizationKeyResponse")
        return try! __request.createObject(node: __result, type:EPA_FdV_AUTHZ_GetAuthorizationKeyResponse.self) as? EPA_FdV_AUTHZ_GetAuthorizationKeyResponse;
    }
}